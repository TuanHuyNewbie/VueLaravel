<template>
    <div>
        <v-row>
            <div id="map" style="width: 80vw; height: 100vh;">
                <InfoXaComponent @hienthiXa="xa" :idHuyen="idHuyen" />
            </div>
            <div style="padding: 10px; width: 20vw; max-height: 100vh;">
                <Info @changeId="change" :info="id" style=" max-width: 100vh; background-color: white;" />
            </div>
        </v-row>
    </div>
</template>
  
<script>
import { Map, View } from 'ol'
import { fromLonLat } from 'ol/proj'
import { Tile as TileLayer, Vector as VectorLayer } from 'ol/layer'
import { OSM, Vector as VectorSource } from 'ol/source'
import { Icon, Style } from 'ol/style'
import Feature from 'ol/Feature'
import Point from 'ol/geom/Point'
import Polygon from 'ol/geom/Polygon';
import { Stroke } from 'ol/style';
import Fill from 'ol/style/Fill';
import { Circle as CircleStyle, Fill as FillStyle, Stroke as StrokeStyle, Style as StyleStyle } from 'ol/style';
import { getArea, getLength } from 'ol/sphere';
import { transform } from 'ol/proj';
import { Draw, Modify, Snap } from 'ol/interaction';
import { defaults as defaultInteractions } from 'ol/interaction';
import { defaults as defaultControls, ScaleLine } from 'ol/control';
import { unByKey } from 'ol/Observable';
import { toStringHDMS } from 'ol/coordinate';
import { LineString, MultiLineString, MultiPoint, MultiPolygon } from 'ol/geom';
import { getCenter } from 'ol/extent';
import AnGiang from '../../../public/json/angiang.json';
import Info from './InfoComponent.vue';
import InfoXaComponent from './InfoXaComponent.vue';
import { mapActions } from 'vuex'
import { isBuffer } from 'util'

export default {
    name: 'Map',
    components: {
        Info,
        InfoXaComponent
    },
    methods: {
        xa(e) {
            let _this = this
            let vectorSource = new VectorSource({
                format: 'EPSG:4326',
                features: []
            });
            !e[1] && this.layerXa && this.map.removeLayer(this.layerXa)

            e[1] && e[0].forEach((xa, index) => {
                let Coord = xa;
                let CDpolygonFeature = new Feature({
                    geometry: new Polygon([Coord]).transform('EPSG:4326', 'EPSG:3857'),
                    properties: {
                        id: index,
                        name: 'xa',
                    }
                });
                vectorSource.addFeature(CDpolygonFeature);


                let CDPolygon = new Polygon([Coord]).transform('EPSG:4326', 'EPSG:3857');
            })
            let CDpolygonStyle = new Style({
                stroke: new Stroke({
                    color: 'red',
                    width: 1,
                    lineDash: [4],
                }),
                fill: new Fill({
                    color: 'rgba(18, 234, 50, 0.3)',
                }),
            });
            let xaborderLayer = new VectorLayer({
                source: vectorSource,
                style: CDpolygonStyle,
                properties: {
                    name: 'xa',
                }
            });
            this.layerXa = (xaborderLayer);

            _this.map.addLayer(xaborderLayer);
        },
        change(e) {
            console.log(e);
        },
        getCenterOfExtent(Extent) {
            var X = Extent[0] + (Extent[2] - Extent[0]) / 2;
            var Y = Extent[1] + (Extent[3] - Extent[1]) / 2;
            return [X, Y];
        },
    },
    data() {
        return {
            id: '',
            idHuyen: -1,
            angiang: AnGiang,
            level2s: [],
            coordsAnGiang: [],
            hienthiXa: '',
            map: '',
            layerXa: [],
        }
    },
    watch: {

    },
    mounted() {
        this.level2s = this.angiang.level2s;

        // Promise.all(
        this.level2s.forEach((huyen) => {
            this.coordsAnGiang.push(huyen.coordinates[0][0]);
        })
        // );
        const anGiangCoords = [

            [
                105.117331968,
                10.9598219660001
            ],
            [
                105.118171918,
                10.951632202
            ],
            [
                105.117872429,
                10.9468265360001
            ],
            [
                105.116780201,
                10.9440807890001
            ],
            [
                105.114298711,
                10.9398644120001
            ],
            [
                105.10715369,
                10.9312361990001
            ],
            [
                105.102166686,
                10.9234162240001
            ],
            [
                105.100473305,
                10.9216224900001
            ],
            [
                105.101957705,
                10.920153715
            ],
            [
                105.10733958,
                10.9177659170001
            ],
            [
                105.110309004,
                10.9168471790001
            ],
            [
                105.131285789,
                10.92344617
            ],
            [
                105.131548397,
                10.923440333
            ],
            [
                105.156528929,
                10.9228836930001
            ],
            [
                105.178424894,
                10.9122266750001
            ],
            [
                105.188918283,
                10.9121360180001
            ],
            [
                105.189402632,
                10.908566955
            ],
            [
                105.190794822,
                10.8955084730001
            ],
            [
                105.190989711,
                10.88739679
            ],
            [
                105.189779972,
                10.872559312
            ],
            [
                105.190173304,
                10.861875539
            ],
            [
                105.190571137,
                10.8583140960001
            ],
            [
                105.192369089,
                10.85455395
            ],
            [
                105.196366203,
                10.8490118140001
            ],
            [
                105.198565524,
                10.847427657
            ],
            [
                105.203565385,
                10.846039494
            ],
            [
                105.211163638,
                10.841879665
            ],
            [
                105.219359453,
                10.834553736
            ],
            [
                105.22095746,
                10.8315849420001
            ],
            [
                105.222152629,
                10.824857412
            ],
            [
                105.223749678,
                10.8207015520001
            ],
            [
                105.231340349,
                10.8078361350001
            ],
            [
                105.23393904,
                10.8060535830001
            ],
            [
                105.238338188,
                10.8048631620001
            ],
            [
                105.242737935,
                10.804464051
            ],
            [
                105.252938072,
                10.8044558720001
            ],
            [
                105.256537109,
                10.803265847
            ],
            [
                105.258935273,
                10.8010875680001
            ],
            [
                105.260895687,
                10.7975808090001
            ],
            [
                105.261616057,
                10.7953174780001
            ],
            [
                105.261614099,
                10.793054748
            ],
            [
                105.261370852,
                10.790196779
            ],
            [
                105.259441121,
                10.7860302230001
            ],
            [
                105.258837373,
                10.7838870960001
            ],
            [
                105.258713731,
                10.7800762860001
            ],
            [
                105.259792871,
                10.7750735720001
            ],
            [
                105.262076464,
                10.7709034660001
            ],
            [
                105.266647652,
                10.767326837
            ],
            [
                105.269244471,
                10.7661335450001
            ],
            [
                105.271581027,
                10.765059831
            ],
            [
                105.275673123,
                10.7643416770001
            ],
            [
                105.280487545,
                10.763741909
            ],
            [
                105.290237843,
                10.763732939
            ],
            [
                105.296857831,
                10.763131215
            ],
            [
                105.30010686,
                10.762056279
            ],
            [
                105.302031417,
                10.7606253170001
            ],
            [
                105.303594114,
                10.758480165
            ],
            [
                105.304072852,
                10.7557406080001
            ],
            [
                105.303708641,
                10.7526446090001
            ],
            [
                105.302261486,
                10.7499069410001
            ],
            [
                105.300454188,
                10.748122332
            ],
            [
                105.29732265,
                10.746100798
            ],
            [
                105.287206307,
                10.740274858
            ],
            [
                105.281907153,
                10.7369451600001
            ],
            [
                105.278172731,
                10.73349488
            ],
            [
                105.276244224,
                10.730519316
            ],
            [
                105.275881422,
                10.7286141860001
            ],
            [
                105.275879587,
                10.7265896340001
            ],
            [
                105.277441978,
                10.724087331
            ],
            [
                105.279005217,
                10.722537749
            ],
            [
                105.284298738,
                10.7201511390001
            ],
            [
                105.291397279,
                10.7175245720001
            ],
            [
                105.296451294,
                10.716567082
            ],
            [
                105.301265384,
                10.716443371
            ],
            [
                105.309330755,
                10.717983647
            ],
            [
                105.317156228,
                10.720238501
            ],
            [
                105.326064783,
                10.7222538090001
            ],
            [
                105.333407606,
                10.7231987590001
            ],
            [
                105.339064143,
                10.722954466
            ],
            [
                105.345199931,
                10.720804098
            ],
            [
                105.349168961,
                10.718417866
            ],
            [
                105.351092999,
                10.7169866200001
            ],
            [
                105.351452827,
                10.7159143980001
            ],
            [
                105.347584111,
                10.7006751540001
            ],
            [
                105.345608936,
                10.6924539620001
            ],
            [
                105.344923932,
                10.6896026700001
            ],
            [
                105.340579474,
                10.6787701650001
            ],
            [
                105.339612524,
                10.674960313
            ],
            [
                105.339127205,
                10.6713881100001
            ],
            [
                105.339718448,
                10.661979289
            ],
            [
                105.341268728,
                10.6493539530001
            ],
            [
                105.342700822,
                10.6387532850001
            ],
            [
                105.34557668,
                10.6281510210001
            ],
            [
                105.349055271,
                10.618738977
            ],
            [
                105.35253584,
                10.6112323460001
            ],
            [
                105.358656422,
                10.5980062940001
            ],
            [
                105.364895806,
                10.58394636
            ],
            [
                105.3681363,
                10.5775116670001
            ],
            [
                105.370418425,
                10.5745317170001
            ],
            [
                105.373183274,
                10.5728611810001
            ],
            [
                105.375468067,
                10.572143925
            ],
            [
                105.385451879,
                10.5714173330001
            ],
            [
                105.388699005,
                10.5706988060001
            ],
            [
                105.392546536,
                10.569145862
            ],
            [
                105.395671803,
                10.56723651
            ],
            [
                105.398796407,
                10.5648507510001
            ],
            [
                105.401319197,
                10.562227562
            ],
            [
                105.409969266,
                10.5538800910001
            ],
            [
                105.412132431,
                10.552329088
            ],
            [
                105.414416494,
                10.5512542820001
            ],
            [
                105.416701022,
                10.550536736
            ],
            [
                105.419587463,
                10.5501756420001
            ],
            [
                105.422955868,
                10.5504093390001
            ],
            [
                105.432580776,
                10.5517063190001
            ],
            [
                105.440401072,
                10.5527673290001
            ],
            [
                105.445332926,
                10.55276042
            ],
            [
                105.446895993,
                10.552281856
            ],
            [
                105.454707417,
                10.5472689260001
            ],
            [
                105.465404349,
                10.54153704
            ],
            [
                105.480068694,
                10.534846094
            ],
            [
                105.481512446,
                10.5350820840001
            ],
            [
                105.484041703,
                10.5372218430001
            ],
            [
                105.487537382,
                10.541980069
            ],
            [
                105.500655078,
                10.546127712
            ],
            [
                105.507390483,
                10.5457597160001
            ],
            [
                105.510155861,
                10.5450407320001
            ],
            [
                105.511843394,
                10.547181611
            ],
            [
                105.513767174,
                10.546702139
            ],
            [
                105.526627791,
                10.54084562
            ],
            [
                105.529632424,
                10.5394115390001
            ],
            [
                105.534797986,
                10.5355919990001
            ],
            [
                105.544646782,
                10.5274771690001
            ],
            [
                105.548968133,
                10.5225870690001
            ],
            [
                105.553639833,
                10.5155680390001
            ],
            [
                105.55412616,
                10.5148373280001
            ],
            [
                105.557723215,
                10.508638386
            ],
            [
                105.557915499,
                10.5082145220001
            ],
            [
                105.563832588,
                10.4951705710001
            ],
            [
                105.569939705,
                10.480749947
            ],
            [
                105.572690779,
                10.472646975
            ],
            [
                105.573401591,
                10.4668103450001
            ],
            [
                105.574580687,
                10.4540657040001
            ],
            [
                105.575770017,
                10.4469182300001
            ],
            [
                105.575765632,
                10.444536461
            ],
            [
                105.573474868,
                10.4412060930001
            ],
            [
                105.572749264,
                10.4389446970001
            ],
            [
                105.573105414,
                10.4364431980001
            ],
            [
                105.573934005,
                10.4292963620001
            ],
            [
                105.57188994,
                10.429300025
            ],
            [
                105.566600066,
                10.429666716
            ],
            [
                105.563475348,
                10.4305058640001
            ],
            [
                105.554465586,
                10.435166103
            ],
            [
                105.552786376,
                10.4335742660001
            ],
            [
                105.551640347,
                10.431277698
            ],
            [
                105.550879739,
                10.430480076
            ],
            [
                105.549834923,
                10.429964913
            ],
            [
                105.54902728,
                10.4294023470001
            ],
            [
                105.548504344,
                10.428839291
            ],
            [
                105.54831314,
                10.428040676
            ],
            [
                105.549068968,
                10.4261125350001
            ],
            [
                105.549162384,
                10.425266439
            ],
            [
                105.549065675,
                10.424232681
            ],
            [
                105.548114794,
                10.423153396
            ],
            [
                105.54678376,
                10.421745792
            ],
            [
                105.546331971,
                10.421159114
            ],
            [
                105.54623601,
                10.4205483210001
            ],
            [
                105.546377868,
                10.420266097
            ],
            [
                105.546756878,
                10.419936475
            ],
            [
                105.548179687,
                10.4195580740001
            ],
            [
                105.551547545,
                10.418988332
            ],
            [
                105.552305478,
                10.418282076
            ],
            [
                105.552303574,
                10.4172011630001
            ],
            [
                105.551970279,
                10.41654379
            ],
            [
                105.551209707,
                10.415746165
            ],
            [
                105.548644958,
                10.414293688
            ],
            [
                105.545605927,
                10.4129359830001
            ],
            [
                105.544846522,
                10.4127962900001
            ],
            [
                105.543565759,
                10.4129864550001
            ],
            [
                105.541431506,
                10.4135070250001
            ],
            [
                105.540672425,
                10.4135553090001
            ],
            [
                105.539865811,
                10.413556671
            ],
            [
                105.5390111,
                10.4131821340001
            ],
            [
                105.538084224,
                10.412220274
            ],
            [
                105.53703764,
                10.4106241490001
            ],
            [
                105.536561959,
                10.409920003
            ],
            [
                105.535659659,
                10.409451543
            ],
            [
                105.533855946,
                10.409031595
            ],
            [
                105.533239138,
                10.409032622
            ],
            [
                105.532812026,
                10.4089863310001
            ],
            [
                105.532289554,
                10.4086582250001
            ],
            [
                105.531861815,
                10.4082359660001
            ],
            [
                105.531576173,
                10.407672484
            ],
            [
                105.531337426,
                10.4067799480001
            ],
            [
                105.53133337,
                10.4043831330001
            ],
            [
                105.530904129,
                10.4030679430001
            ],
            [
                105.529975396,
                10.400978137
            ],
            [
                105.529452623,
                10.400462036
            ],
            [
                105.528835426,
                10.400228074
            ],
            [
                105.527649442,
                10.4003240220001
            ],
            [
                105.525586465,
                10.4008678640001
            ],
            [
                105.525112004,
                10.400868641
            ],
            [
                105.524589935,
                10.4007755110001
            ],
            [
                105.524210059,
                10.400588144
            ],
            [
                105.52406717,
                10.400259401
            ],
            [
                105.52401878,
                10.399695523
            ],
            [
                105.52439584,
                10.3981910150001
            ],
            [
                105.525858868,
                10.3935359550001
            ],
            [
                105.52609224,
                10.39123274
            ],
            [
                105.526182252,
                10.3883188020001
            ],
            [
                105.526320262,
                10.3857337600001
            ],
            [
                105.527098791,
                10.383171164
            ],
            [
                105.528563851,
                10.3797850010001
            ],
            [
                105.528703972,
                10.378468866
            ],
            [
                105.528795856,
                10.376682847
            ],
            [
                105.528342749,
                10.3752501980001
            ],
            [
                105.527391857,
                10.3740298490001
            ],
            [
                105.525159738,
                10.3726236050001
            ],
            [
                105.521693692,
                10.3709373670001
            ],
            [
                105.520600435,
                10.3696702250001
            ],
            [
                105.520266019,
                10.368260875
            ],
            [
                105.520264234,
                10.3671799530001
            ],
            [
                105.52089965,
                10.3632482520001
            ],
            [
                105.520723974,
                10.3631581500001
            ],
            [
                105.520200192,
                10.3629673180001
            ],
            [
                105.519452187,
                10.3628487300001
            ],
            [
                105.518305465,
                10.3628026650001
            ],
            [
                105.517258377,
                10.3627085100001
            ],
            [
                105.516111429,
                10.3625186730001
            ],
            [
                105.514714736,
                10.3620417130001
            ],
            [
                105.513691992,
                10.361588107
            ],
            [
                105.512868469,
                10.3610143820001
            ],
            [
                105.511969942,
                10.3602970110001
            ],
            [
                105.511170887,
                10.359435724
            ],
            [
                105.510396454,
                10.3583827150001
            ],
            [
                105.509771852,
                10.357497198
            ],
            [
                105.509072674,
                10.356731586
            ],
            [
                105.508298949,
                10.3561098550001
            ],
            [
                105.507425789,
                10.355655991
            ],
            [
                105.506503054,
                10.3553699240001
            ],
            [
                105.505306274,
                10.3551801260001
            ],
            [
                105.504034809,
                10.355038355
            ],
            [
                105.502614125,
                10.3551124590001
            ],
            [
                105.501666963,
                10.3551378940001
            ],
            [
                105.501068537,
                10.3550190290001
            ],
            [
                105.500320138,
                10.354636833
            ],
            [
                105.499796001,
                10.3542063630001
            ],
            [
                105.499321341,
                10.35353622
            ],
            [
                105.498946042,
                10.352650284
            ],
            [
                105.498420851,
                10.351548942
            ],
            [
                105.497971011,
                10.350806875
            ],
            [
                105.497346762,
                10.3501130020001
            ],
            [
                105.496622967,
                10.34951513
            ],
            [
                105.495550284,
                10.348965709
            ],
            [
                105.494477764,
                10.3485121150001
            ],
            [
                105.493380086,
                10.3479148000001
            ],
            [
                105.492431889,
                10.347269328
            ],
            [
                105.491657846,
                10.346407958
            ],
            [
                105.490758551,
                10.34513945
            ],
            [
                105.490533403,
                10.344612667
            ],
            [
                105.490544693,
                10.34244878
            ],
            [
                105.491144187,
                10.3400573160001
            ],
            [
                105.490935553,
                10.338828796
            ],
            [
                105.487621347,
                10.3345328990001
            ],
            [
                105.494742165,
                10.3268664240001
            ],
            [
                105.490638645,
                10.325631161
            ],
            [
                105.487216918,
                10.3238044070001
            ],
            [
                105.486976076,
                10.323623066
            ],
            [
                105.486752032,
                10.3231939180001
            ],
            [
                105.486216635,
                10.321427226
            ],
            [
                105.485732929,
                10.319743047
            ],
            [
                105.485215112,
                10.318224108
            ],
            [
                105.484680542,
                10.3169860040001
            ],
            [
                105.484267018,
                10.31624328
            ],
            [
                105.483871188,
                10.31583091
            ],
            [
                105.482942253,
                10.3151385080001
            ],
            [
                105.481256583,
                10.3139847160001
            ],
            [
                105.46875914,
                10.310744716
            ],
            [
                105.426683503,
                10.30307759
            ],
            [
                105.441451154,
                10.2696872390001
            ],
            [
                105.428451305,
                10.2648334520001
            ],
            [
                105.414660471,
                10.259298357
            ],
            [
                105.401305511,
                10.254031583
            ],
            [
                105.399537273,
                10.2533276610001
            ],
            [
                105.366013587,
                10.2434654890001
            ],
            [
                105.336302039,
                10.2342571630001
            ],
            [
                105.31228309,
                10.2742851690001
            ],
            [
                105.306399704,
                10.2688558180001
            ],
            [
                105.301195559,
                10.2771243390001
            ],
            [
                105.287251033,
                10.2625707830001
            ],
            [
                105.289065777,
                10.2598356130001
            ],
            [
                105.266912128,
                10.238492133
            ],
            [
                105.260813271,
                10.2458753810001
            ],
            [
                105.252928692,
                10.2383076830001
            ],
            [
                105.246177809,
                10.229296447
            ],
            [
                105.23160063,
                10.209090971
            ],
            [
                105.227590085,
                10.2132053060001
            ],
            [
                105.227174235,
                10.2126319270001
            ],
            [
                105.225892838,
                10.2107569990001
            ],
            [
                105.22421493,
                10.2084426980001
            ],
            [
                105.222598,
                10.2061283470001
            ],
            [
                105.221347194,
                10.204341308
            ],
            [
                105.21887633,
                10.2011189030001
            ],
            [
                105.216710484,
                10.1981893780001
            ],
            [
                105.213598956,
                10.193824276
            ],
            [
                105.210274026,
                10.18922481
            ],
            [
                105.207986355,
                10.1861780580001
            ],
            [
                105.205955048,
                10.1835572730001
            ],
            [
                105.165411249,
                10.218654724
            ],
            [
                105.144044566,
                10.237146065
            ],
            [
                105.141752541,
                10.2384454080001
            ],
            [
                105.126260271,
                10.2529337230001
            ],
            [
                105.115461254,
                10.259108971
            ],
            [
                105.1033244,
                10.2658909190001
            ],
            [
                105.0951452,
                10.2706140230001
            ],
            [
                105.093131305,
                10.2717769070001
            ],
            [
                105.081842241,
                10.2781442620001
            ],
            [
                105.070003743,
                10.285357387
            ],
            [
                105.056756289,
                10.2930841520001
            ],
            [
                105.040828442,
                10.302034227
            ],
            [
                105.016868538,
                10.315981245
            ],
            [
                105.018698513,
                10.3186049820001
            ],
            [
                105.005682118,
                10.3216271220001
            ],
            [
                105.00178752,
                10.3225505840001
            ],
            [
                104.979665503,
                10.327583986
            ],
            [
                104.903216607,
                10.344965401
            ],
            [
                104.868960579,
                10.352747328
            ],
            [
                104.867379679,
                10.353817964
            ],
            [
                104.865348339,
                10.3551936310001
            ],
            [
                104.864358881,
                10.3558637030001
            ],
            [
                104.8383516,
                10.3894916100001
            ],
            [
                104.830333886,
                10.399856754
            ],
            [
                104.827433402,
                10.4036062210001
            ],
            [
                104.829546746,
                10.406114078
            ],
            [
                104.820219158,
                10.4219325350001
            ],
            [
                104.819271246,
                10.423539971
            ],
            [
                104.809048622,
                10.4408738830001
            ],
            [
                104.796857821,
                10.467661965
            ],
            [
                104.791154577,
                10.473799925
            ],
            [
                104.778319178,
                10.4876123920001
            ],
            [
                104.782652776,
                10.504129651
            ],
            [
                104.783254294,
                10.506422163
            ],
            [
                104.781009111,
                10.5086638020001
            ],
            [
                104.779568779,
                10.511616546
            ],
            [
                104.778426952,
                10.5196525050001
            ],
            [
                104.803805662,
                10.5204296430001
            ],
            [
                104.809488941,
                10.5205391430001
            ],
            [
                104.837208249,
                10.521349792
            ],
            [
                104.844821759,
                10.521459635
            ],
            [
                104.867930411,
                10.5218411970001
            ],
            [
                104.879829164,
                10.532660784
            ],
            [
                104.890418345,
                10.5421685260001
            ],
            [
                104.898405534,
                10.5495202390001
            ],
            [
                104.901751849,
                10.5559414680001
            ],
            [
                104.91552623,
                10.580384861
            ],
            [
                104.928445074,
                10.6031309900001
            ],
            [
                104.934181519,
                10.6128337650001
            ],
            [
                104.937011815,
                10.616780862
            ],
            [
                104.938363702,
                10.6186661290001
            ],
            [
                104.945334658,
                10.6267255070001
            ],
            [
                104.954075643,
                10.6370645800001
            ],
            [
                104.95995806,
                10.6446797200001
            ],
            [
                104.969168208,
                10.6494587340001
            ],
            [
                104.976379219,
                10.652116199
            ],
            [
                104.994390434,
                10.664288024
            ],
            [
                105.001789544,
                10.668762938
            ],
            [
                105.022797379,
                10.681089593
            ],
            [
                105.064789265,
                10.705609188
            ],
            [
                105.094285921,
                10.722854232
            ],
            [
                105.092619696,
                10.7333163920001
            ],
            [
                105.087617944,
                10.7564435850001
            ],
            [
                105.086337347,
                10.7581801960001
            ],
            [
                105.074080133,
                10.774800859
            ],
            [
                105.064062353,
                10.7768220080001
            ],
            [
                105.061836713,
                10.7799425910001
            ],
            [
                105.060725663,
                10.79040444
            ],
            [
                105.060541927,
                10.799397793
            ],
            [
                105.06147137,
                10.808023856
            ],
            [
                105.060730608,
                10.8149984070001
            ],
            [
                105.04700434,
                10.841980699
            ],
            [
                105.035873194,
                10.8643736550001
            ],
            [
                105.030307561,
                10.8810760640001
            ],
            [
                105.028823972,
                10.8926389800001
            ],
            [
                105.035724021,
                10.897957783
            ],
            [
                105.039775192,
                10.9010804110001
            ],
            [
                105.041445945,
                10.903649693
            ],
            [
                105.039219716,
                10.9111749530001
            ],
            [
                105.040333823,
                10.9146619840001
            ],
            [
                105.047758605,
                10.9174139560001
            ],
            [
                105.05109981,
                10.9186981620001
            ],
            [
                105.050172278,
                10.9218184270001
            ],
            [
                105.049059447,
                10.9269576070001
            ],
            [
                105.049988021,
                10.9298940260001
            ],
            [
                105.055371751,
                10.9342979510001
            ],
            [
                105.064839652,
                10.939985683
            ],
            [
                105.070965509,
                10.941085533
            ],
            [
                105.075791617,
                10.940533771
            ],
            [
                105.076163337,
                10.942369033
            ],
            [
                105.07672182,
                10.9486090940001
            ],
            [
                105.077465096,
                10.951545471
            ],
            [
                105.079694397,
                10.957968624
            ],
            [
                105.082834291,
                10.9567683670001
            ],
            [
                105.087471452,
                10.955418524
            ],
            [
                105.09084402,
                10.9548290700001
            ],
            [
                105.094018279,
                10.9545338790001
            ],
            [
                105.097688744,
                10.9549250370001
            ],
            [
                105.101260225,
                10.955904644
            ],
            [
                105.108800978,
                10.9604135970001
            ],
            [
                105.112968026,
                10.9620793930001
            ],
            [
                105.11455531,
                10.9622749480001
            ],
            [
                105.115646404,
                10.961980306
            ],
            [
                105.116737342,
                10.9612933500001
            ],
            [
                105.117331968,
                10.9598219660001
            ]
        ];
        // Tạo bản đồ
        this.map = new Map({
            target: 'map',
            layers: [
                new TileLayer({
                    source: new OSM(),
                }),
            ],
            view: new View({
                center: [0, 0],
                zoom: 6,
            }),
        });

        const polygonFeature = new Feature({
            geometry: new Polygon([anGiangCoords]).transform('EPSG:4326', 'EPSG:3857')
        });

        const borderLayer = new VectorLayer({
            source: new VectorSource({
                features: [polygonFeature],
            }),
            style: polygonStyle,
            properties: {
                name: 'poligon1'
            }
        });

        this.map.addLayer(borderLayer);
        // Lấy giới hạn của đối tượng feature
        const polygonExtent = polygonFeature.getGeometry().getExtent();
        // Đặt giới hạn hiển thị cho bản đồ
        this.map.setView(new View({
            center: getCenter(polygonExtent),
            zoom: 10,
        }));
        const polygonStyle = new Style({
            stroke: new Stroke({
                color: 'red',
                width: 1,
                lineDash: [4],
            }),
        });

        polygonFeature.setStyle(polygonStyle);
        // Promise.all(
        this.coordsAnGiang.forEach((huyen, index) => {
            let Coord = huyen;
            let CDpolygonFeature = new Feature({
                geometry: new Polygon([Coord]).transform('EPSG:4326', 'EPSG:3857')
            });

            let CDpolygonStyle = new Style({
                stroke: new Stroke({
                    color: 'rgb(0, 128, 0)',
                    width: 1,
                    lineDash: [4],
                }),
                fill: new Fill({
                    color: 'rgba(128, 234, 250, 0.3)',
                }),
            });
            let CDborderLayer = new VectorLayer({
                source: new VectorSource({
                    features: [CDpolygonFeature],
                }),
                style: CDpolygonStyle,
                properties: {
                    id: index,
                    name: 'huyen'
                }
            });
            let CDPolygon = new Polygon([Coord]).transform('EPSG:4326', 'EPSG:3857');
            let _this = this;
            this.map.on(
                'click', async function (evt) {
                    let pixel = _this.map.getEventPixel(evt.originalEvent);
                    let coordinate = _this.map.getCoordinateFromPixel(pixel);
                    if (CDPolygon.intersectsCoordinate(coordinate)) {
                        _this.idHuyen = CDborderLayer.getProperties().id;
                        _this.id = CDborderLayer.getProperties().id;
                        CDborderLayer.setStyle(
                            new Style({
                                stroke: new Stroke({
                                    color: 'red',
                                    width: 1,
                                    lineDash: [4],
                                }),
                                fill: new Fill({
                                    color: 'rgba(100, 24, 250, 0.1)',
                                }),
                            })
                        );
                        _this.map.getView().animate({
                            center: _this.getCenterOfExtent(
                                CDborderLayer.getSource().getFeatures()[0].getGeometry().getExtent()
                            ),
                            zoom: 12,
                            duration: 500
                        })
                    } else {
                        CDborderLayer.setStyle(
                            new Style({
                                stroke: new Stroke({
                                    color: 'rgb(0, 128, 0)',
                                    width: 1,
                                    lineDash: [4],
                                }),
                                fill: new Fill({
                                    color: 'rgba(128, 234, 250, 0.3)',
                                }),
                            })
                        );
                    }
                }
            );
            this.map.addLayer(CDborderLayer);
        })
        let _this = this;
                this.map.on(
                    'click', async function (evt) {
                        let pixel = _this.map.getEventPixel(evt.originalEvent);
                        let coordinate = _this.map.getCoordinateFromPixel(pixel);
                            let featureAtPixel = _this.map.forEachFeatureAtPixel(pixel, (e) => {
                                if(e.getProperties().properties){
                                    
                                    e.setStyle(
                                        new Style({
                                            stroke: new Stroke({
                                                color: 'red',
                                                width: 1,
                                                lineDash: [4],
                                            }),
                                            fill: new Fill({
                                                color: 'rgba(117, 117, 163, 0.1)',
                                            }),
                                        })
                                    );
                                } 
                            });
                    })
    },
}
</script>
  
<style scoped>
#map {
    height: 100vh;
}
</style>
  